# site-modules/profile/plans/ssh_config.yaml

description: "Configure SSH to disable StrictHostKeyChecking"
parameters:
  targets:
    type: TargetSpec
    default: all
    description: "The targets to run the plan on"

steps:
  - name: set_ssh_config_content
    eval: |
      $config_content = @("CONFIG")
      Host *
          StrictHostKeyChecking no
          UserKnownHostsFile /dev/null
      | CONFIG

  - name: upload_config
    command: "echo '${$config_content}' > ~/.ssh/config"
    targets: $targets

  - name: set_permissions
    command: "chmod 600 ~/.ssh/config"
    targets: $targets

return: "SSH Config set successfully on ${$targets}"
